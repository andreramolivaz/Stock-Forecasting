

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Data Preprocessing &#8212; Stock Forecast</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '01-preparation_analysis/data_preprocessing';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Exploratory Data Analysis" href="exploratory_data_analysis.html" />
    <link rel="prev" title="Data Retrivial" href="data_retrivial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Stock Forecast - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Stock Forecast - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Preparation and Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="data_retrivial.html">Data Retrivial</a></li>



<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploratory_data_analysis.html">Exploratory Data Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Data Modeling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Supervised_Learning.html">Data Preparation</a></li>





<li class="toctree-l1"><a class="reference internal" href="reinforcement_learning.html">Reinforcement Learning</a></li>



</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/andreramolivaz/CT0590/tree/data-model" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/andreramolivaz/CT0590/tree/data-model/issues/new?title=Issue%20on%20page%20%2F01-preparation_analysis/data_preprocessing.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/01-preparation_analysis/data_preprocessing.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Preprocessing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-libraries">Importing Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-data-retrieval-infrastructure">Setting Up Data Retrieval Infrastructure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-of-financial-data">Integration of Financial Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">Feature Engineering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#financial-data-integration-and-feature-engineering">Financial Data Integration and Feature Engineering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#export-del-dataset-finale">Export del dataset finale</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-preprocessing">
<h1>Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Permalink to this heading">#</a></h1>
<section id="importing-libraries">
<h2>Importing Libraries<a class="headerlink" href="#importing-libraries" title="Permalink to this heading">#</a></h2>
<p>In this section, we are initializing our environment with three fundamental Python libraries that will facilitate data analysis, numerical operations, and file management. Here’s a brief overview of each:</p>
<ol class="arabic simple">
<li><p><strong>pandas (<code class="docutils literal notranslate"><span class="pre">pd</span></code>)</strong>:</p>
<ul class="simple">
<li><p><strong>Description</strong>: pandas is a powerful library for data manipulation and analysis. It offers data structures like DataFrames and Series that simplify handling structured data.</p></li>
<li><p><strong>Usage</strong>: Throughout this notebook, we’ll utilize <code class="docutils literal notranslate"><span class="pre">pd</span></code> for tasks like data ingestion, cleaning, transformation, and aggregation.</p></li>
</ul>
</li>
<li><p><strong>numpy (<code class="docutils literal notranslate"><span class="pre">np</span></code>)</strong>:</p>
<ul class="simple">
<li><p><strong>Description</strong>: numpy is the core library for numerical computing in Python. It provides support for working with arrays (including mathematical functions to operate on these arrays), which is essential for various data science tasks.</p></li>
<li><p><strong>Usage</strong>: We’ll employ <code class="docutils literal notranslate"><span class="pre">np</span></code> whenever we need to perform mathematical and statistical operations, especially when dealing with arrays or matrices of data.</p></li>
</ul>
</li>
<li><p><strong>os</strong>:</p>
<ul class="simple">
<li><p><strong>Description</strong>: The os module provides a way of using operating system-dependent functionality, such as reading or writing to the file system.</p></li>
<li><p><strong>Usage</strong>: In this notebook, <code class="docutils literal notranslate"><span class="pre">os</span></code> will be instrumental in tasks related to file management, such as directory creation, file path handling, and checking the presence of files.</p></li>
</ul>
</li>
</ol>
<p>By importing these libraries, we’re equipping our notebook with the tools necessary to handle a wide range of data analysis and computational tasks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="setting-up-data-retrieval-infrastructure">
<h2>Setting Up Data Retrieval Infrastructure<a class="headerlink" href="#setting-up-data-retrieval-infrastructure" title="Permalink to this heading">#</a></h2>
<p>This code segment establishes the foundation for managing and processing our financial data. It can be broken down into two main sections:</p>
<ol class="arabic simple">
<li><p><strong>Predefined Sheet Names</strong>:</p>
<ul class="simple">
<li><p><strong>Description</strong>: We define a list called <code class="docutils literal notranslate"><span class="pre">sheet_names</span></code> that contains the names of sheets expected in the Excel files. Each of these sheets corresponds to a specific type of financial data.</p></li>
<li><p><strong>Usage</strong>: This predefined list will be instrumental when reading and processing data from Excel files, ensuring that we access the correct sheets and maintain consistency in data handling.</p></li>
</ul>
</li>
<li><p><strong>Retrieving File Paths for Data Processing:</strong></p>
<ul class="simple">
<li><p><strong>Description</strong>: The above code sets the path to the directory where all the Excel files (with financial data) are stored. It then constructs a list called <code class="docutils literal notranslate"><span class="pre">stocks</span></code>, containing the full paths to each of these files.</p></li>
<li><p><strong>Usage</strong>: With this setup, we’ll have easy access to all the Excel files in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory, facilitating bulk processing and analysis of the financial data contained in them.</p></li>
</ul>
</li>
</ol>
<p>In essence, this segment prepares our environment to efficiently load, access, and analyze the financial datasets saved in the Excel format.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sheet_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Info&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Historical&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Income Statement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Quarterly Income Statement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Cashflow&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Institutional Holders&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mutual Fund Holders&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Major Holders&#39;</span>
<span class="p">]</span>

<span class="c1">#riempire stocks di tutti i vari codici, fare la retrive di tutti i file e buttarli in df_stock per poi poter lavorare su tutti i dati</span>
<span class="n">directory</span> <span class="o">=</span> <span class="s2">&quot;./data&quot;</span>
<span class="n">stocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">directory</span><span class="p">)]</span>
<span class="n">stocks</span> <span class="o">=</span> <span class="p">[</span><span class="n">stock</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">stock</span> <span class="ow">in</span> <span class="n">stocks</span><span class="p">]</span> <span class="c1"># lambda per unificare i percorsi tra mac e windows</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="integration-of-financial-data">
<h2>Integration of Financial Data<a class="headerlink" href="#integration-of-financial-data" title="Permalink to this heading">#</a></h2>
<p>Added columns:</p>
<ul class="simple">
<li><p><strong>Daily_Return</strong>: Represents the daily return.</p></li>
<li><p><strong>Target_1day</strong>: Indicates whether the closing price the next day will be higher (1) or lower (0) than the current day’s closing price.</p></li>
<li><p><strong>Target_5days</strong>: Specifies if the closing price 5 days into the future will be higher (1) or lower (0) than the closing price of the current day.</p></li>
<li><p><strong>Target_30days</strong>: Determines if the closing price 30 days into the future will be higher (1) or lower (0) compared to the current day’s closing price.</p></li>
<li><p><strong>Net income</strong> (Income statement): This metric calculates a company’s profit after all expenses and taxes have been deducted. It stands as the most critical measure for investors, showcasing the company’s bottom line.</p></li>
<li><p><strong>Diluted EPS</strong> (Income statement): Measures the company’s profit for each share of common stock, offering a clear picture of the company’s profitability per share.</p></li>
<li><p><strong>Total Revenue</strong> (Income statement): Reflects the total sales a company achieves. It provides a snapshot of the company’s top line growth.</p></li>
<li><p><strong>Cost of revenue</strong> (Income statement): Calculates the cost of the goods the company sells, an essential measure for gauging a company’s profitability.</p></li>
<li><p><strong>Operating revenue</strong> (Income statement): Captures the non-production costs incurred by a company. It’s vital to factor in operating expenses when assessing a company’s profitability and cash flow potential.</p></li>
<li><p><strong>Cash flow from continuing operating activities</strong> (Cashflow): Represents the cash generated by a company from its primary business ventures.</p></li>
<li><p><strong>Cash flow from continuing investing activities</strong> (Cashflow): Indicates the cash a company earns from its investments, such as selling property or equipment.</p></li>
<li><p><strong>Cash flow from continuing financing activities</strong> (Cashflow): Reflects the cash a company secures from its financing activities, like issuing debt or equity.</p></li>
</ul>
<p>We’ve merged the “Income Statement” and “Cashflow” sheets into one Excel document. Note: As these sheets contain yearly or quarterly financial data, a common approach is to carry forward the last known value for each day until new data becomes available. For certain fiscal years, the value will be NaN as we don’t possess the data.</p>
<p>The dataframes for each stock were truncated at 06/30/2020 and were also individually exported for potential future use. Lastly, we combined all stocks into a singular final dataset, identifying each using the “Ticker” feature we’ve added.</p>
<p>Some companies lacked complete financial data for our analysis. Therefore, by mutual agreement, we chose to still consider such data, filling in the missing features with neutral values (0). This enables us to include these data points and add value to the analysis of companies whose data is available.</p>
</section>
<section id="feature-engineering">
<h2>Feature Engineering<a class="headerlink" href="#feature-engineering" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><strong>Moving Averages</strong>: We calculate short and long-term moving averages for the closing price, which are standard in algorithmic trading. For instance, moving averages over 5, 10, 30, and 50 days.</p></li>
<li><p><strong>RSI (Relative Strength Index)</strong>: This is a momentum indicator that can help identify if a stock is in an “overbought” or “oversold” condition.</p></li>
<li><p><strong>MACD (Moving Average Convergence Divergence)</strong>: Another momentum indicator.</p></li>
<li><p><strong>Bollinger Bands</strong>: These are based on moving averages and can help determine if a price is relatively high or low.</p></li>
<li><p><strong>Volatility</strong>: We might compute volatility as the standard deviation of daily returns over a specific timeframe.</p></li>
</ul>
<section id="financial-data-integration-and-feature-engineering">
<h3>Financial Data Integration and Feature Engineering<a class="headerlink" href="#financial-data-integration-and-feature-engineering" title="Permalink to this heading">#</a></h3>
<p>This code block is designed to process financial data for multiple stocks, adding derived features, and integrating various sheets from Excel files into a unified DataFrame structure. Here’s a step-by-step explanation:</p>
<ol class="arabic simple">
<li><p><strong>Initialization</strong>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">counter</span></code> is set to 0, which will be used later in the code.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df</span></code> is an empty DataFrame that will store the consolidated data from all processed stocks.</p></li>
</ul>
</li>
<li><p><strong>Iterating through Stock Files</strong>:
The loop goes through each file path in the <code class="docutils literal notranslate"><span class="pre">stocks</span></code> list, representing different stocks’ data.</p></li>
<li><p><strong>Loading Excel Data</strong>:
The code reads an Excel file corresponding to a specific stock into the <code class="docutils literal notranslate"><span class="pre">df_stock</span></code> DataFrame.</p></li>
<li><p><strong>Processing ‘Historical’ Data</strong>:</p>
<ul class="simple">
<li><p>The ‘Historical’ sheet is loaded.</p></li>
<li><p>The date column is renamed and set as the index.</p></li>
<li><p>The ‘Daily_Return’ column is calculated to represent the daily percentage change in the closing price.</p></li>
<li><p>Three target columns (<code class="docutils literal notranslate"><span class="pre">Target_1day</span></code>, <code class="docutils literal notranslate"><span class="pre">Target_5days</span></code>, and <code class="docutils literal notranslate"><span class="pre">Target_30days</span></code>) are added to indicate whether the closing price in the future (1, 5, or 30 days respectively) will be higher than the current day’s closing price.</p></li>
<li><p>Rows with NaN values (resulting from the target creation process) are dropped.</p></li>
</ul>
</li>
<li><p><strong>Processing ‘Income Statement’ Data</strong>:</p>
<ul class="simple">
<li><p>The ‘Income Statement’ sheet is loaded and transposed for easier integration.</p></li>
<li><p>Key financial metrics (like ‘Net Income’, ‘Diluted EPS’, etc.) are selected.</p></li>
<li><p>Missing columns for the selected metrics are created and filled with NaN values.</p></li>
<li><p>The data is then merged with the historical stock data.</p></li>
</ul>
</li>
<li><p><strong>Processing ‘Cashflow’ Data</strong>:</p>
<ul class="simple">
<li><p>Similar to the ‘Income Statement’ data, the ‘Cashflow’ sheet is loaded, transposed, and key metrics are selected.</p></li>
<li><p>The cashflow data is then merged with the existing DataFrame.</p></li>
</ul>
</li>
<li><p><strong>Feature Engineering</strong>:
The following technical indicators and financial metrics are calculated and added to the DataFrame:</p>
<ul class="simple">
<li><p><strong>Moving Averages</strong>: Calculated for the closing prices over 5, 10, 30, and 50 days.</p></li>
<li><p><strong>RSI (Relative Strength Index)</strong>: A momentum indicator.</p></li>
<li><p><strong>MACD</strong>: Another momentum indicator with a corresponding signal line.</p></li>
<li><p><strong>Bollinger Bands</strong>: Used to determine relative high or low prices.</p></li>
<li><p><strong>Volatility</strong>: Calculated as the standard deviation of daily returns over a specified window.</p></li>
</ul>
</li>
<li><p><strong>Final Processing</strong>:</p>
<ul class="simple">
<li><p>A ‘Ticker’ column is added to the DataFrame to store the stock’s identifier.</p></li>
<li><p>NaN values in various columns are filled with neutral values (0).</p></li>
<li><p>The data is truncated to only include entries after ‘2020-06-30’.</p></li>
<li><p>Each processed stock’s data is saved in the ‘Processed’ directory.</p></li>
<li><p>The processed stock’s data is then appended to the consolidated DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code>.</p></li>
</ul>
</li>
</ol>
<p>In essence, this code processes financial data for multiple stocks, derives meaningful metrics, integrates different data sheets, and prepares the data for further analysis or modeling tasks.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">stocks</span><span class="p">:</span>
    <span class="n">df_stock</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelFile</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    
    <span class="c1"># prevent false postive warnings, reference_ https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># default=&#39;warn&#39;</span>
    
    <span class="c1"># Loading the &#39;Historical&#39; data stock</span>
    <span class="n">historical_data</span> <span class="o">=</span> <span class="n">df_stock</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;Historical&#39;</span><span class="p">)</span>
    
    <span class="c1"># Renaming and setting the Date column</span>
    <span class="n">historical_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">:</span> <span class="s1">&#39;Date&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">])</span>
    <span class="n">historical_data</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Calculate daily return</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Daily_Return&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">]</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Daily_Return_Percentage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Open&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">])</span> <span class="o">*</span> <span class="mi">100</span>
    
    
    <span class="c1"># Create target variables for next day, next 5 days and next 30 days</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Target_1day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Target_5days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Target_30days&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">N</span> <span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">5</span> <span class="p">:</span>
            <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Target_5days&#39;</span><span class="p">][</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Target_1day&#39;</span><span class="p">][</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Target_30days&#39;</span><span class="p">][</span><span class="o">-</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Percentage_Return_1day_before&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Percentage_Return_5days_before&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Percentage_Return_15days_before&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Percentage_Return_30days_before&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">30</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Percentage_Return_90days_before&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">90</span><span class="p">))</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">90</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Percentage_Return_180days_before&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">180</span><span class="p">))</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">180</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Percentage_Return_360days_before&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">360</span><span class="p">))</span> <span class="o">/</span> <span class="n">historical_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">360</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
        
    <span class="c1"># Drop rows with NaN values (will be present due to the shifting for target creation)</span>
    <span class="n">historical_data</span> <span class="o">=</span> <span class="n">historical_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    
    <span class="n">income_statement</span> <span class="o">=</span> <span class="n">df_stock</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;Income Statement&#39;</span><span class="p">)</span>
    
    <span class="c1"># Transposing the data for easier integration</span>
    <span class="n">income_statement</span> <span class="o">=</span> <span class="n">income_statement</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">income_statement</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">income_statement</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    
    
    <span class="c1"># Selecting some of the key financial metrics (you can add or remove based on relevance)</span>
    <span class="n">selected_metrics</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Net Income&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Diluted EPS&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Total Revenue&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Normalized EBITDA&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Total Unusual Items&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Total Unusual Items Excluding Goodwill&#39;</span>
    <span class="p">]</span>
    
    <span class="c1"># check if columns exist, in case create them</span>
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">selected_metrics</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">metric</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">income_statement</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">income_statement</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            
    
    <span class="n">income_statement</span> <span class="o">=</span> <span class="n">income_statement</span><span class="p">[</span><span class="n">selected_metrics</span><span class="p">]</span>
    
    <span class="c1"># Merging the income statement data with the historical data</span>
    <span class="n">merged_data</span> <span class="o">=</span> <span class="n">historical_data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">income_statement</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
    
    <span class="c1"># Forward filling the NaN values</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="n">selected_metrics</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="n">selected_metrics</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>
    
    <span class="n">cashflow</span> <span class="o">=</span> <span class="n">df_stock</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;Cashflow&#39;</span><span class="p">)</span>
    
    <span class="c1"># Transposing the data for easier integration</span>
    <span class="n">cashflow</span> <span class="o">=</span> <span class="n">cashflow</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">cashflow</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">cashflow</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
    
    <span class="c1"># Selecting some of the key cashflow metrics (you can add or remove based on relevance)</span>
    <span class="n">selected_cashflow_metrics</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;Operating Cash Flow&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Capital Expenditure&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Free Cash Flow&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Cash Flow From Continuing Operating Activities&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Cash Flow From Continuing Investing Activities&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Cash Flow From Continuing Financing Activities&#39;</span>
    <span class="p">]</span>
    
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">selected_cashflow_metrics</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">metric</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cashflow</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">cashflow</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="n">cashflow</span> <span class="o">=</span> <span class="n">cashflow</span><span class="p">[</span><span class="n">selected_cashflow_metrics</span><span class="p">]</span>
    
    <span class="c1"># Merging the cashflow data with the existing dataframe</span>
    <span class="n">merged_data</span> <span class="o">=</span> <span class="n">merged_data</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cashflow</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_cashflow&#39;</span><span class="p">)</span>
    
    <span class="c1"># Forward filling the NaN values</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="n">selected_cashflow_metrics</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="n">selected_cashflow_metrics</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span>

    <span class="c1"># Moving Averages</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;MA_5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;MA_10&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;MA_30&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;MA_50&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># RSI</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
    <span class="n">gain</span> <span class="o">=</span> <span class="p">(</span><span class="n">delta</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">delta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">delta</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">avg_gain</span> <span class="o">=</span> <span class="n">gain</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">avg_loss</span> <span class="o">=</span> <span class="n">loss</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">rs</span> <span class="o">=</span> <span class="n">avg_gain</span> <span class="o">/</span> <span class="n">avg_loss</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;RSI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">-</span> <span class="p">(</span><span class="mi">100</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rs</span><span class="p">))</span>
    
    <span class="c1"># MACD</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;MACD&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">span</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">adjust</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">span</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">adjust</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Signal_Line&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;MACD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">span</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">adjust</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    <span class="c1"># Bollinger Bands</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Bollinger_Mid_Band&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Bollinger_Upper_Band&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Bollinger_Mid_Band&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Bollinger_Lower_Band&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Bollinger_Mid_Band&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    
    <span class="c1"># Volatility</span>
    <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Volatility&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Daily_Return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    
    <span class="n">to_drop_na</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MA_5&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_10&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_30&#39;</span><span class="p">,</span> <span class="s1">&#39;MA_50&#39;</span><span class="p">,</span> <span class="s1">&#39;RSI&#39;</span><span class="p">,</span> <span class="s1">&#39;Volatility&#39;</span><span class="p">,</span> <span class="s1">&#39;Cash Flow From Continuing Operating Activities&#39;</span><span class="p">,</span> <span class="s1">&#39;Cash Flow From Continuing Investing Activities&#39;</span><span class="p">,</span> <span class="s1">&#39;Cash Flow From Continuing Financing Activities&#39;</span><span class="p">,</span> <span class="s1">&#39;Net Income&#39;</span><span class="p">,</span> <span class="s1">&#39;Diluted EPS&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Revenue&#39;</span><span class="p">,</span><span class="s1">&#39;Normalized EBITDA&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Unusual Items&#39;</span><span class="p">,</span> <span class="s1">&#39;Total Unusual Items Excluding Goodwill&#39;</span><span class="p">,</span> <span class="s1">&#39;Operating Cash Flow&#39;</span><span class="p">,</span> <span class="s1">&#39;Capital Expenditure&#39;</span><span class="p">,</span><span class="s1">&#39;Free Cash Flow&#39;</span><span class="p">,]</span>

    <span class="k">if</span> <span class="s1">&#39;Ticker&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">merged_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">merged_data</span><span class="p">[</span><span class="s1">&#39;Ticker&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        
    <span class="c1"># Display the updated dataframe with integrated cashflow metrics</span>
    <span class="n">merged_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">counter</span> <span class="p">:</span> <span class="n">counter</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_data</span><span class="p">),</span> <span class="n">merged_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s2">&quot;Ticker&quot;</span><span class="p">)]</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        
    <span class="n">counter</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_data</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">to_drop_na</span><span class="p">:</span>
        <span class="n">merged_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">merged_data</span> <span class="o">=</span> <span class="n">merged_data</span><span class="p">[</span><span class="n">merged_data</span><span class="o">.</span><span class="n">index</span> <span class="o">&gt;=</span> <span class="s1">&#39;2020-06-30&#39;</span><span class="p">]</span>
    <span class="c1">#indices_to_drop = merged_data.index[merged_data.isna().sum(axis=1) &gt; 3].tolist()</span>
    
    <span class="c1">#merged_data.drop(indices_to_drop, inplace=True)</span>
    
    <span class="c1"># Export in Excel company data</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;./Processed&#39;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;./Processed&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./Processed/</span><span class="si">{</span><span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">2</span><span class="p">][:</span><span class="o">-</span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">engine</span> <span class="o">=</span> <span class="s2">&quot;openpyxl&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
        <span class="n">merged_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
    <span class="c1"># Append to one single dataframe</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df</span><span class="p">,</span> <span class="n">merged_data</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:32: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_1day&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:30: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_5days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:33: FutureWarning: Series.__setitem__ treating keys as positions is deprecated. In a future version, integer keys will always be treated as labels (consistent with DataFrame behavior). To set a value by position, use `ser.iloc[pos] = value`
  historical_data[&#39;Target_30days&#39;][-i] = -1
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:76: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_metrics] = merged_data[selected_metrics].fillna(method=&#39;ffill&#39;)
/var/folders/kl/fcwqs6xs30b3g73_r8l0_q5m0000gn/T/ipykernel_6317/4035912320.py:104: FutureWarning: DataFrame.fillna with &#39;method&#39; is deprecated and will raise in a future version. Use obj.ffill() or obj.bfill() instead.
  merged_data[selected_cashflow_metrics] = merged_data[selected_cashflow_metrics].fillna(method=&#39;ffill&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="export-del-dataset-finale">
<h2>Export del dataset finale<a class="headerlink" href="#export-del-dataset-finale" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_filepath</span> <span class="o">=</span> <span class="s2">&quot;final_dataset.xlsx&quot;</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">output_filepath</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./01-preparation_analysis"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="data_retrivial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Data Retrivial</p>
      </div>
    </a>
    <a class="right-next"
       href="exploratory_data_analysis.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Exploratory Data Analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-libraries">Importing Libraries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setting-up-data-retrieval-infrastructure">Setting Up Data Retrieval Infrastructure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#integration-of-financial-data">Integration of Financial Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-engineering">Feature Engineering</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#financial-data-integration-and-feature-engineering">Financial Data Integration and Feature Engineering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#export-del-dataset-finale">Export del dataset finale</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By André Ramolivaz, Alberto Tomasin, Simone Dinato
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>